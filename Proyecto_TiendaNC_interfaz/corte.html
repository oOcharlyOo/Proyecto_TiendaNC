<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Punto de Venta - CORTE DE CAJA</title>
    <!-- Incluir Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Incluir Chart.js para la gráfica -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="resources/style/estilos.css">
</head>
<body class="main-page-body">
    
    <!-- BARRA SUPERIOR DE NAVEGACIÓN -->
    <div id="navbar-placeholder"></div>

    <div class="main-container" style="height: max-content;">
        <div class="items-center justify-center w-full panel-transparent rounded-lg shadow-2xl p-4 sm:p-6 md:p-8 space-y-4 sm:space-y-6 md:space-y-8 z-50">
            <header class="border-b pb-4">
                <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">Corte de Caja</h1>
                <p class="text-sm sm:text-base text-gray-600 mt-1">Genera y visualiza el reporte de tu corte de caja o consulta reportes de días anteriores.</p>
            </header>

            <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 mb-4 sm:mb-8 justify-center">
                <button id="generateCorteBtn" class="btn-primary text-white font-semibold py-2 px-6 sm:py-3 sm:px-8 rounded-lg transition duration-150 shadow-md text-base sm:text-lg">
                    Generar Corte de Caja
                </button>
                <button id="generateDailyReportBtn" class="btn-primary text-white font-semibold py-2 px-6 sm:py-3 sm:px-8 rounded-lg transition duration-150 shadow-md text-base sm:text-lg hidden">
                    Generar Reporte por Día
                </button>
            </div>

            <section id="corteReporte" class="hidden">
                <h2 id="reportTitle" class="text-lg sm:text-xl font-semibold text-gray-700 mb-3 sm:mb-4">Reporte del Corte</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6">
                    <div class="summary-card income-card">
                        <p class="summary-title text-xs sm:text-sm whitespace-normal break-words">Fecha del Reporte</p>
                        <p id="reporteFechaCorte" class="summary-value text-xl sm:text-2xl text-gray-800 whitespace-normal break-words"></p>
                    </div>
                    <div class="summary-card income-card">
                        <p class="summary-title text-xs sm:text-sm whitespace-normal break-words">Cajero</p>
                        <p id="reporteCajero" class="summary-value text-xl sm:text-2xl text-gray-800 whitespace-normal break-words"></p>
                    </div>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6 mt-4 sm:mt-6">
                    <div class="summary-card">
                        <p class="summary-title text-xs sm:text-sm text-income-color whitespace-normal break-words">Monto Inicial</p>
                        <p id="reporteMontoInicial" class="summary-value text-xl sm:text-2xl income-value whitespace-normal break-words"></p>
                    </div>
                    <!-- New card for Ventas en Efectivo -->
                    <div class="summary-card">
                        <p class="summary-title text-xs sm:text-sm text-income-color whitespace-normal break-words">Ventas en Efectivo</p>
                        <p id="reporteVentasEfectivo" class="summary-value text-xl sm:text-2xl income-value whitespace-normal break-words"></p>
                    </div>
                    <!-- Ventas por Transferencia (formerly Otros Ingresos) -->
                    <div class="summary-card">
                        <p class="summary-title text-xs sm:text-sm text-profit-color whitespace-normal break-words">Ventas por Transferencia</p>
                        <p id="reporteOtrosIngresos" class="summary-value text-xl sm:text-2xl income-value whitespace-normal break-words"></p>
                    </div>
                    <!-- Tickets del Día -->
                    <div class="summary-card">
                        <p class="summary-title text-xs sm:text-sm text-cash-flow-color whitespace-normal break-words">Tickets del Día</p>
                        <p id="reporteTotalTicketsDia" class="summary-value text-xl sm:text-2xl whitespace-normal break-words">0</p>
                    </div>
                    <!-- Total Ventas (SPANS 2 COLUMNS) -->
                    <div class="summary-card md:col-span-2">
                        <p class="summary-title text-xs sm:text-sm text-income-color whitespace-normal break-words">Total Ventas</p>
                        <p id="reporteTotalVentas" class="summary-value text-xl sm:text-2xl income-value whitespace-normal break-words"></p>
                    </div>
                    <!-- Total Egresos -->
                    <div class="summary-card">
                        <p class="summary-title text-xs sm:text-sm text-danger whitespace-normal break-words">Total Egresos</p>
                        <p id="reporteTotalEgresos" class="summary-value text-xl sm:text-2xl expense-value whitespace-normal break-words"></p>
                    </div>
                    <!-- Ganancia Total -->
                    <div class="summary-card profit-card">
                        <p class="summary-title text-xs sm:text-sm text-profit-color whitespace-normal break-words">Ganancia Total</p>
                        <p id="reporteGananciaTotal" class="summary-value text-xl sm:text-2xl profit-value whitespace-normal break-words"></p>
                        <p class="text-xs text-gray-500 mt-1">Beneficio total del corte</p>
                    </div>
                </div>

                <div class="summary-card cash-flow-card mt-4 sm:mt-6">
                    <p class="summary-title text-sm sm:text-base text-profit-color whitespace-normal break-words">SALDO FINAL CALCULADO</p>
                    <p id="reporteSaldoFinalCalculado" class="summary-value text-3xl sm:text-4xl cash-flow-value whitespace-normal break-words"></p>
                </div>
                
                <!-- GRÁFICA PIE CHART AGREGADA AQUÍ -->
                <div class="mt-6 sm:mt-8">
                    <h3 id="chartTitle" class="text-lg sm:text-xl font-semibold text-gray-700 mb-3 sm:mb-4 border-t pt-3 sm:pt-4">Composición del Flujo de Efectivo Bruto (Entradas)</h3>
                    <div class="panel-transparent p-4 sm:p-6 rounded-xl shadow-lg flex justify-center items-center min-h-0">
                        <canvas id="cashFlowChart"></canvas>
                    </div>
                </div>
                <!-- FIN GRÁFICA -->
                
                <div class="flex justify-center pt-6 sm:pt-8">
                    <button id="cerrarTurnoBtn" class="btn-primary text-white font-semibold py-2 px-8 sm:py-3 sm:px-12 rounded-lg transition duration-150 shadow-xl text-base sm:text-lg">
                        Cerrar Turno
                    </button>
                </div>
            </section>
        </div>
    </div>

    <!-- Modal para seleccionar fecha de reporte diario -->
    <div id="dailyReportModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-20 mx-auto p-5 border w-11/12 max-w-sm shadow-lg rounded-md bg-white">
            <div class="mt-3 text-center">
                <h3 class="text-lg leading-6 font-medium text-gray-900">Generar Reporte por Día</h3>
                <div class="mt-4 px-7 py-3">
                    <label for="reportDate" class="block text-sm font-medium text-gray-700 text-left">Selecciona una fecha:</label>
                    <input type="date" id="reportDate" name="reportDate" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm">
                </div>
                <div class="items-center px-4 py-3 space-x-4">
                    <button id="generateReportFromModalBtn" class="px-4 py-2 btn-primary text-white text-base font-medium rounded-md shadow-sm hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary">
                        Generar Reporte
                    </button>
                    <button id="cancelModalBtn" class="px-4 py-2 btn-secondary text-white text-base font-medium rounded-md shadow-sm hover:bg-secondary-dark focus:outline-none focus:ring-2 focus:ring-secondary">
                        Cancelar
                    </button>
                </div>
            </div>
        </div>
    </div>


        <script src="nav.js"></script>
        <script src="resources/js/corte.js"></script>
</body>
</html>